<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:IPGeoLocator.ViewModels"
        xmlns:local="clr-namespace:IPGeoLocator.Controls"
        x:Class="IPGeoLocator.Views.WorldMapView"
        Title="World Map Visualization"
        Width="1000" Height="700"
        MinWidth="800" MinHeight="600">
  
  <Grid RowDefinitions="Auto,*,Auto">
    <!-- Toolbar -->
    <Border Grid.Row="0" Classes="Card" Margin="10">
      <StackPanel Orientation="Horizontal" Spacing="10" Margin="10">
        <TextBlock Text="World Map Visualization" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
        <Button Name="RefreshButton" Content="Refresh" Command="{Binding RefreshCommand}" Margin="20,0,0,0"/>
        <Button Name="ExportButton" Content="Export Map" Command="{Binding ExportMapCommand}"/>
        <Button Name="ClearButton" Content="Clear" Command="{Binding ClearMapCommand}"/>
        <CheckBox Name="ThreatFilterCheckBox" Content="Show Only Threats" IsChecked="{Binding ShowOnlyThreats}" Margin="20,0,0,0"/>
        <Slider Name="ZoomSlider" Value="{Binding ZoomLevel}" Minimum="1" Maximum="10" Width="100" Margin="10,0,0,0"/>
        <TextBlock Text="{Binding ZoomLevel, StringFormat='Zoom: {0:F1}'}" VerticalAlignment="Center"/>
      </StackPanel>
    </Border>
    
    <!-- Map Visualization Area -->
    <Border Grid.Row="1" Margin="10,0,10,10" Classes="Card">
      <Grid>
        <!-- Status overlay -->
        <Panel IsVisible="{Binding IsLoading}" Background="#80000000" ZIndex="10">
          <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="10">
            <ProgressBar IsIndeterminate="True" Width="200"/>
            <TextBlock Text="{Binding StatusMessage}" Foreground="White" HorizontalAlignment="Center"/>
          </StackPanel>
        </Panel>
        
        <!-- Map display area using the custom control -->
        <local:WorldMapControl Name="WorldMapControl"/>
      </Grid>
    </Border>
    
    <!-- Status Bar -->
    <Border Grid.Row="2" Background="{DynamicResource SystemAltHighBrush}" Padding="10">
      <Grid ColumnDefinitions="*,Auto">
        <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center"/>
        <TextBlock Grid.Column="1" Text="{Binding MapPoints.Count, StringFormat='{}{0} points'}" 
                   VerticalAlignment="Center" Margin="20,0,0,0"/>
      </Grid>
    </Border>
  </Grid>
</Window>