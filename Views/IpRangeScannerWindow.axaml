<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:IPGeoLocator.ViewModels"
        xmlns:controls="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.DataGrid"
        x:Class="IPGeoLocator.Views.IpRangeScannerWindow"
        Title="IP Range Scanner"
        Width="800" Height="600"
        MinWidth="600" MinHeight="400">
  
  <Grid RowDefinitions="Auto,*,Auto">
    <!-- Input Section -->
    <Border Grid.Row="0" Classes="Card" Margin="10">
      <StackPanel Spacing="10" Margin="10">
        <TextBlock Text="IP Range Scanner" FontSize="20" FontWeight="Bold" />
        
        <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" RowDefinitions="Auto,Auto" Margin="0,10,0,0">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Start IP:" VerticalAlignment="Center" Margin="0,0,10,0"/>
          <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding StartIpAddress}" Watermark="e.g., 192.168.1.1" Margin="0,0,10,0"/>
          
          <TextBlock Grid.Row="0" Grid.Column="2" Text="End IP:" VerticalAlignment="Center" Margin="0,0,10,0"/>
          <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding EndIpAddress}" Watermark="e.g., 192.168.1.254" Margin="0,0,10,0"/>
          
          <TextBlock Grid.Row="0" Grid.Column="4" Text="Concurrent:" VerticalAlignment="Center" Margin="0,0,10,0"/>
          <NumericUpDown Grid.Row="0" Grid.Column="5" Value="{Binding ConcurrentScans}" Minimum="1" Maximum="50" Width="80"/>
          
          <Button Grid.Row="1" Grid.Column="0" Content="Start Scan" Command="{Binding StartScanCommand}" 
                  IsEnabled="{Binding !IsScanning}" Classes="accent" Margin="0,10,10,0"/>
          <Button Grid.Row="1" Grid.Column="1" Content="Cancel" Command="{Binding CancelScanCommand}" 
                  IsEnabled="{Binding IsScanning}" Margin="0,10,10,0"/>
          <Button Grid.Row="1" Grid.Column="2" Content="Export Results" Command="{Binding ExportResultsCommand}" 
                  Margin="0,10,10,0"/>
        </Grid>
      </StackPanel>
    </Border>
    
    <!-- Status and Progress -->
    <Border Grid.Row="1" Background="{DynamicResource SystemAltHighBrush}" Margin="10,0,10,10" Padding="10">
      <StackPanel>
        <TextBlock Text="{Binding ScanStatus}" FontWeight="Medium" Margin="0,0,0,5"/>
        <ProgressBar IsVisible="{Binding IsScanning}" Value="{Binding Progress}" IsIndeterminate="False" Height="20"/>
        <TextBlock Text="{Binding CompletedIps, StringFormat='{}{0} of {1} IP addresses processed'}" 
                   IsVisible="{Binding IsScanning}" 
                   Margin="0,5,0,0"/>
      </StackPanel>
    </Border>
    
    <!-- Results Grid -->
    <DataGrid Grid.Row="2" 
              ItemsSource="{Binding ScanResults}"
              Margin="10,0,10,10"
              AutoGenerateColumns="False"
              HeadersVisibility="All"
              SelectionMode="Single">
      <DataGrid.Columns>
        <DataGridTextColumn Header="IP Address" Binding="{Binding IpAddress}" Width="120"/>
        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
        <DataGridTextColumn Header="Country" Binding="{Binding Country}" Width="100"/>
        <DataGridTextColumn Header="City" Binding="{Binding City}" Width="100"/>
        <DataGridTextColumn Header="ISP" Binding="{Binding Isp}" Width="150"/>
        <DataGridTextColumn Header="Threat Score" Binding="{Binding ThreatScore}" Width="80"/>
      </DataGrid.Columns>
    </DataGrid>
  </Grid>
</Window>